function canvasSupport(){return!!document.createElement("testcanvas").getContext}function eventWindowLoaded(){resume.startMessageLoop()}var gameLogic=function(){function s(e,f,g,h){d=e,c=f,b=g,a=h,o[0]=document.getElementById("result0"),o[1]=document.getElementById("result1"),o[2]=document.getElementById("result2")}function t(a){e=0,f=0,g=0,h=0,i=a,j=30,k=0,n=0,p=0,D(),A(1),r=q.slideIn}function u(a,b){e=a>=10&&200>a&&b>470&&590>b?1:0,f=a>=200&&390>a&&b>470&&590>b?1:0}function v(){r==q.result?1==f?(p=2,L()):1==e&&(p=1,L()):1==f?C(0):1==e&&C(1)}function w(a){r==q.result?(37==a.keyCode&&(p=1,g=0,L()),39==a.keyCode&&(p=2,h=0,L())):(37==a.keyCode&&(C(1),g=0),39==a.keyCode&&(C(0),h=0))}function x(a){37==a.keyCode&&(g=1),39==a.keyCode&&(h=1)}function A(a){z=a,y=0>a?0:-470}function B(){const a=25;y+=a*z,0>z&&-470>y?(y=-470,K(),r=q.result):z>0&&y>0&&(y=0,r=q.gameplay)}function C(a){r==q.gameplay&&0==n&&(1==i&&(a=0==a?1:0),a==l?(k+=10*Math.floor(j),j+=.3,j>30&&(j=30),b.correct.currentTime=0,b.correct.play(),n=8):(j-=1,b.wrong.currentTime=0,b.wrong.play(),n=-8))}function D(){l=Math.random()<.5?0:1,m=Math.floor(15*Math.random())}function F(){switch(r){case q.slideIn:B();break;case q.gameplay:j-=1/30,0>j&&(j=0,A(-1),r=q.slideOut);break;case q.slideOut:B();break;case q.backToTitle:E++}}function G(){if(F(),a.fillStyle="#cedfe7",a.fillRect(0,0,d.screenWidth,d.screenHeight),r==q.backToTitle){var b=M();return b}return r==q.slideIn&&a.drawImage(c.title,0,40),a.textBaseline="bottom",a.fillStyle="#000000",a.font="bold 64px Arial",r==q.result&&(a.textAlign="center",a.fillText(k,200,180)),0==l?a.drawImage(c.flowers[m],5,y+5):a.drawImage(c.bananas[m],5,y+5),a.drawImage(c.frame,0,y),n>0&&(a.drawImage(c.answere,0,0,350,350,25,70,350,350),n--,0==n&&D()),0>n&&(a.drawImage(c.answere,350,0,350,350,25,70,350,350),n++,0==n&&D()),r==q.result?I():H(),1==i&&a.drawImage(c.mode,0,0,80,80,235,y,60,60),a.font="bold 24px Arial",a.textAlign="right",a.fillText(J(k,6),380,28+y),5>j&&(a.fillStyle="#ff0000"),a.font="bold 62px Arial",a.textAlign="left",a.fillText(j.toFixed(1),20,65+y),0}function H(){0==e&&0==g?a.drawImage(c.buttons,0,0,200,130,0,470,200,130):a.drawImage(c.buttons,200,0,200,130,0,470,200,130),0==f&&0==h?a.drawImage(c.buttons,0,130,200,130,200,470,200,130):a.drawImage(c.buttons,200,130,200,130,200,470,200,130)}function I(){0==e&&0==g?a.drawImage(c.buttons,0,520,200,130,0,470,200,130):a.drawImage(c.buttons,200,520,200,130,0,470,200,130),0==f&&0==h?a.drawImage(c.buttons,0,650,200,130,200,470,200,130):a.drawImage(c.buttons,200,650,200,130,200,470,200,130)}function J(a,b){return a.length>=b?a:J("0"+a,b)}function K(){2e3>=k?o[0].style.visibility="":4e3>=k?o[1].style.visibility="":o[2].style.visibility=""}function L(){o[0].style.visibility="hidden",o[1].style.visibility="hidden",o[2].style.visibility="hidden",E=0,r=q.backToTitle}function M(){return a.globalAlpha=E/40,a.drawImage(c.title,0,40),a.drawImage(c.buttons,0,390,200,130,0,470,200,130),a.drawImage(c.buttons,0,260,200,130,200,470,200,130),a.globalAlpha=1,40==E?p:0}var a,b,c,d,e,f,g,h,i,j,k,l,m,n,p,o=new Array(3);const q={unknown:-1,slideIn:0,gameplay:1,slideOut:2,result:3,backToTitle:4};var r,y,z,E;return{init:s,reset:t,draw:G,eventMouseMove:u,eventMouseClick:v,eventKeyUp:w,eventKeyDown:x}}(),loader=function(){function d(d,e,f){c=d,b=e,a=f}function e(d){a.fillStyle="#cedfe7",a.fillRect(0,0,c.screenWidth,c.screenHeight),a.textBaseline="bottom",a.fillStyle="#000000",a.font="14px monospace",a.textAlign="center",a.fillText(d+"%",c.screenWidth/2,355);for(var e=0;5>e;e++)d>=20*(e+1)?a.drawImage(b.bar,0,0,64,64,40+64*e,268,64,64):a.drawImage(b.bar,64,0,64,64,40+64*e,268,64,64)}function h(a){b=a,f=0,g=0}function i(){a.fillStyle="#cedfe7",a.fillRect(0,0,c.screenWidth,c.screenHeight);var d;switch(f){case 0:for(a.globalAlpha=1-g/40,d=0;5>d;d++)a.drawImage(b.bar,0,0,64,64,40+64*d,268,64,64);a.globalAlpha=1,40==g&&(f=1,g=0);break;case 1:a.globalAlpha=40>=g?g/40:80>=g?1:1-(g-80)/40,a.textBaseline="bottom",a.fillStyle="#000000",a.font="18px 微軟正黑體",a.textAlign="center",a.fillText("謹獻給",c.screenWidth/2,c.screenHeight/2-20),a.fillText("為民主挺身而出的勇士們",c.screenWidth/2,c.screenHeight/2+20),a.globalAlpha=1,120==g&&(f=2,g=0);break;case 2:a.globalAlpha=g/40,a.drawImage(b.title,0,40),a.drawImage(b.buttons,0,390,200,130,0,470,200,130),a.drawImage(b.buttons,0,260,200,130,200,470,200,130),a.globalAlpha=1,40==g&&(f=3,g=0)}return g++,3==f?c.mainStates.resetTitle:c.mainStates.unknown}var a,b,c,f,g;return{init:d,draw:e,resetIntro:h,drawIntro:i}}(),resume=function(){function t(){var a;switch(r){case q.initial:D();break;case q.preloading:E();break;case q.initLoader:I();break;case q.loading:loader.draw(Math.ceil(100*H/G)),L();break;case q.loadComplete:K(),loader.resetIntro({bar:n,buttons:j,title:i}),r=q.intro;break;case q.intro:a=loader.drawIntro(),L(),a!=q.unknown&&(r=q.resetTitle);break;case q.resetTitle:title.reset(),r=q.title;break;case q.title:a=title.draw(),L(),a!=q.unknown&&(r=q.resetGame);break;case q.resetGame:gameLogic.reset(s),r=q.game;break;case q.game:a=gameLogic.draw(),L(),1==a?(s=0,r=q.resetTitle):2==a&&(s=1,r=q.resetTitle)}}function w(b){switch(b.offsetX||0==b.offsetX?(u=b.offsetX,v=b.offsetY):(b.layerX||0==b.layerX)&&(u=b.layerX-a.offsetLeft,v=b.layerY-a.offsetTop),r){case q.title:title.eventMouseMove(u,v);break;case q.game:gameLogic.eventMouseMove(u,v)}}function x(a){switch(r){case q.title:title.eventMouseClick(a);break;case q.game:gameLogic.eventMouseClick(a)}}function y(a){if(37==a.keyCode||39==a.keyCode)switch(r){case q.title:title.eventKeyUp(a);break;case q.game:gameLogic.eventKeyUp(a)}}function z(a){if(37==a.keyCode||39==a.keyCode)switch(r){case q.title:title.eventKeyDown(a);break;case q.game:gameLogic.eventKeyDown(a)}}function D(){document.getElementById("result0").style.visibility="hidden",document.getElementById("result1").style.visibility="hidden",document.getElementById("result2").style.visibility="hidden",n.src="image/BananaLoader.png",n.onload=F,a=document.getElementById("canvas"),a.width=e,a.height=f,b=a.getContext("2d"),c=document.createElement("canvas"),c.width=e,c.height=f,d=c.getContext("2d"),a.addEventListener("mousemove",w,!0),a.addEventListener("click",x,!0),document.addEventListener("keyup",y,!0),document.addEventListener("keydown",z,!0),r=q.preloading}function E(){b.fillStyle="#ffffff",b.fillRect(0,0,e,f),b.textBaseline="bottom",b.fillStyle="#000000",b.font="14px monospace",b.textAlign="center",b.fillText("Preparing ...",200,300)}function F(){B++,B==A&&(r=q.initLoader)}function I(){i.src="image/Title.png",i.onload=J,j.src="image/Buttons.png",j.onload=J,k.src="image/Frame.png",k.onload=J,l.src="image/Mode.png",l.onload=J,m.src="image/Answere.png",m.onload=J,M();for(var a=1;15>=a;a++)g[a-1]=new Image,g[a-1].src="image/Banana/"+a+".jpg",g[a-1].onload=J,h[a-1]=new Image,h[a-1].src="image/Sunflower/"+a+".jpg",h[a-1].onload=J;loader.init(C,{bar:n},d),r=q.loading}function J(){H++,H==G&&(r=q.loadComplete)}function K(){title.init(C,{buttons:j,title:i},d),gameLogic.init(C,{buttons:j,title:i,frame:k,mode:l,answere:m,bananas:g,flowers:h},{correct:o,wrong:p},d)}function L(){b.drawImage(c,0,0)}function M(){var a;o=document.createElement("audio"),document.body.appendChild(o),a=O(o),o.setAttribute("src","sound/Correct"+a),o.addEventListener("canplaythrough",J,!1),p=document.createElement("audio"),document.body.appendChild(p),p.setAttribute("src","sound/Wrong"+a),p.addEventListener("canplaythrough",J,!1)}function O(a){var b="";return"probably"==a.canPlayType("audio/ogg")||"maybe"==a.canPlayType("audio/ogg")?b=".ogg":("probably"==a.canPlayType("audio/mp3")||"maybe"==a.canPlayType("audio/mp3"))&&(b=".mp3"),b}function P(){const a=30;var b=1e3/a;setInterval(t,b)}if(canvasSupport){var a,b,c,d;const e=400,f=600;var o,p,g=new Array(15),h=new Array(15),i=new Image,j=new Image,k=new Image,l=new Image,m=new Image,n=new Image;const q={preloading:1,initLoader:2,loading:3,loadComplete:4,intro:5,resetTitle:6,title:7,resetGame:8,game:9};var s,u,v,r=q.initial,A=1,B=0,C={mainStates:q,screenWidth:e,screenHeight:f},G=35,H=0;return{startMessageLoop:P}}}();window.addEventListener("load",eventWindowLoaded,!1);var title=function(){function i(d,e,f){c=d,b=e,a=f}function j(){d=0,e=0,f=0,g=0,h=0}function k(a,b){e=a>=10&&200>a&&b>470&&590>b?1:0,d=a>=200&&390>a&&b>470&&590>b?1:0}function l(){if(1==e){var b=window.open();b.location="MoreInfo.html"}1==d&&(h=1)}function m(a){if(37==a.keyCode){g=0;var b=window.open();b.location="MoreInfo.html"}39==a.keyCode&&(f=0,h=1)}function n(a){37==a.keyCode&&(g=1),39==a.keyCode&&(f=1)}function o(){return a.fillStyle="#cedfe7",a.fillRect(0,0,c.screenWidth,c.screenHeight),a.drawImage(b.title,0,40),0==d&&0==f?a.drawImage(b.buttons,0,260,200,130,200,470,200,130):a.drawImage(b.buttons,200,260,200,130,200,470,200,130),0==e&&0==g?a.drawImage(b.buttons,0,390,200,130,0,470,200,130):a.drawImage(b.buttons,200,390,200,130,0,470,200,130),1==h?c.mainStates.resetGame:c.mainStates.unknown}var a,b,c,d,e,f,g,h;return{init:i,reset:j,draw:o,eventMouseMove:k,eventMouseClick:l,eventKeyUp:m,eventKeyDown:n}}();